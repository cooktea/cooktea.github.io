---
title: 从零开始用C++写即时聊天(准备开发环境)
date: 2022-02-11
categories:
- Learning Something
---

# 从零开始用C++写即时聊天(准备开发环境)
## 安装mongodb环境
虚拟机里面已经安装好了docker，所以直接用docker构建mongodb的容器。 
由于使用C++进行服务端的开发，查阅mongo官网后发现c++的最新版driver只支持4.4及以下版本的mongodb，所以最后决定使用4.2版本的镜像搭建mongodb的环境。
```
sudo docker pull mongo:4.2

docker run -itd --name mongo -p 27017:27017 mongo --auth

```

## 配置linux开发环境
- ubuntu16.04-server
- 安装mongo驱动环境
  - 安装编译环境
    ```
    apt-get install libmongoc-1.0-0
    apt-get install libbson-1.0-0
    sudo apt-get install cmake libssl-dev libsasl2-dev
    ```
  - 下载并编译mongo c driver
    ```
    wget https://github.com/mongodb/mongo-c-driver/releases/download/1.21.0/mongo-c-driver-1.21.0.tar.gz
    tar xzf mongo-c-driver-1.21.0.tar.gz
    cd mongo-c-driver-1.21.0
    mkdir cmake-build
    cd cmake-build
    cmake -DENABLE_AUTOMATIC_INIT_AND_CLEANUP=OFF ..
    cmake --build .
    sudo cmake --build . --target install
    ```
  - 编译并安装mongo cxx driver
    ```
    curl -OL https://github.com/mongodb/mongo-cxx-driver/releases/download/r3.6.6/mongo-cxx-driver-r3.6.6.tar.gz
    tar -xzf mongo-cxx-driver-r3.6.6.tar.gz
    cd mongo-cxx-driver-r3.6.6/build
    cmake .. -DCMAKE_BUILD_TYPE=Release -DCMAKE_INSTALL_PREFIX=/usr/local -DBSONCXX_POLY_USE_MNMLSTC=1
    sudo make EP_mnmlstc_core
    sudo make
    sudo make install
    ```


## 参考资料
[https://docs.mongodb.com/drivers/cxx/](https://docs.mongodb.com/drivers/cxx/)  
[https://www.runoob.com/docker/docker-install-mongodb.html](https://www.runoob.com/docker/docker-install-mongodb.html)  
[http://mongocxx.org/mongocxx-v3/installation/linux/](http://mongocxx.org/mongocxx-v3/installation/linux/)  
[http://mongoc.org/libmongoc/current/installing.html](http://mongoc.org/libmongoc/current/installing.html)  
